<article tdPageBackground nebula="features" planet="blue_pink">
  <div *ngIf="lecture$ | async as lecture" class="article-content">
    <section class="page-section nebula-section">
      <a tdLink="/lectures">
        <td-heading-with-highlights [value]="allLecturesHeading" class="bp-site-title" level="h2" />
      </a>
    </section>

    <div class="resource-section">
      <section>
        <td-heading-with-highlights [value]="lecture.title" level="h1" />
        <ul *ngIf="!lecture.lectureSlidesURL" class="wd-subtitle text-p1">
          <li>Lecture</li>
          <li>
            <mat-icon svgIcon="calendar" />
            <span class="cdk-visually-hidden">Date/Time:</span>
            <span *ngIf="lecture.isFinished()">On-Demand</span>
            <time *ngIf="!lecture.isFinished()" [dateTime]="lecture.datetime.toISOString()">
              {{ lecture.datetime | ordinalDate }},
              {{ lecture.datetime | date: "shortTime" }}
              {{ localTimezoneAbbreviation(lecture) }}
            </time>
          </li>
          <li>
            <mat-icon svgIcon="time" />
            <span class="cdk-visually-hidden">Duration:</span>
            {{ lecture.durationMins | eventDuration }}
          </li>
        </ul>
        <td-actions *ngIf="downloadSlidesActions$ | async as actions" [actions]="actions" class="ld-download-slides" />
        <td-aspect-ratio *ngIf="safeVideoURL$ | async as safeVideoURL" class="ld-video-container" ratio="16:9">
          <iframe
            class="ld-video-frame"
            [src]="safeVideoURL"
            title="Video player"
            frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
            allowfullscreen
          ></iframe>
        </td-aspect-ratio>
        <div class="subsection-margin wd-details-area">
          <div *ngIf="(safeVideoURL$ | async) === null" class="card wd-form-card">
            <h3>
              <strong>{{ lecture.isFinished() ? "Watch Lecture" : "Register for Lecture" }}</strong>
            </h3>
            <div id="hubspot-form-holder"></div>
            <aside>
              By submitting your personal data, you consent to emails from Vaticle. See our
              <a href="/legal/privacy-policy" target="_blank">Privacy Policy</a>.
            </aside>
            <mat-progress-bar *ngIf="isSubmitting$ | async" mode="indeterminate" />
          </div>
          <div>
            <td-rich-text [value]="lecture.description" [class]="(safeVideoURL$ | async) !== null ? 'ld-cols-2' : ''" />
            <ul class="wd-speakers subsection-margin">
              <li *ngFor="let speaker of lecture.speakers">
                <td-person-card [person]="speaker" />
              </li>
            </ul>
          </div>
        </div>
      </section>
      <td-further-learning *ngIf="lecture.furtherLearning" [value]="lecture.furtherLearning" />
    </div>
  </div>
</article>
